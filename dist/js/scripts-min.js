var pokemonRepository = function () { var e = [], a = "https://pokeapi.co/api/v2/pokemon/?limit=150", t = $("#pokemon-modal-container"), o = $("ul"); function n(a) { e.push(a) } function d(e) { pokemonRepository.loadDetails(e).then(function () { s(e) }) } function s(e) { t.empty(); var a = $('<div role="document"></div>').addClass("modal-dialog"), o = $("<div></div>").addClass("modal-content"), n = $("<div></div>").addClass("modal-header"), d = $("<h2></h2>").addClass("modal-title").text(e.name), s = $('<button type="button" data-dismiss="modal" aria-label="Close"></button>').addClass("close").text("close").on("click", p), i = $("<div></div>").addClass("modal-body"), l = $("<img src=" + e.imageUrl + ">").addClass("pokemon-img"), c = $("<div></div>").addClass("container"), r = $("<div></div").addClass("row"), m = $("<h3></h3>").addClass("col").text("Type(s)"), h = $("<p></p>").addClass("col").text(e.types), u = $("<div></div").addClass("row"), y = $("<h3></h3>").addClass("col").text("Height"), C = $("<p></p>").addClass("col").text(e.height + "m"), v = $("<div></div").addClass("row"), g = $("<h3></h3>").addClass("col").text("Weight"), f = $("<p></p>").addClass("col").text(e.weight + "kg"); n.append(d), n.append(s), o.append(n), r.append(m), r.append(h), u.append(y), u.append(C), v.append(g), v.append(f), c.append(r), c.append(u), c.append(v), i.append(l), i.append(c), o.append(i), a.append(o), t.append(a), t.addClass("is-visible") } function p() { t.removeClass("is-visible") } return $(window).on("keydown", e => { "Escape" === e.key && t.hasClass("is-visible") && p() }), t.on("click", e => { $(e.target).is(t) && p() }), { add: n, getAll: function () { return e }, addListItem: function (e) { var a = $("<li></li>").addClass("list-group-item"), t = $('<button type="button" data-toggle="modal" data-target="#modal"></button>').addClass("pokemon-button btn btn-lg btn-block").text(e.name); a.append(t), o.append(a), t.on("click", function () { d(e) }) }, showDetails: d, loadList: function () { return $.ajax(a, { dataType: "json" }).then(function (e) { $.each(e.results, function (e, a) { n({ name: a.name.charAt(0).toUpperCase() + a.name.slice(1), detailsUrl: a.url }) }) }).catch(function (e) { console.error(e) }) }, loadDetails: function (e) { var a = e.detailsUrl; return $.ajax(a, { dataType: "json" }).then(function (a) { e.name = e.name, e.imageUrl = a.sprites.front_default, e.height = a.height, e.weight = a.weight, 2 === a.types.length ? e.types = [a.types[1].type.name.charAt(0).toUpperCase() + a.types[1].type.name.slice(1)] + " / " + [a.types[0].type.name.charAt(0).toUpperCase() + a.types[0].type.name.slice(1)] : e.types = [a.types[0].type.name.charAt(0).toUpperCase() + a.types[0].type.name.slice(1)] }).catch(function (e) { console.error(e) }) }, showModal: s, hideModal: p } }(); pokemonRepository.loadList().then(function () { pokemonRepository.getAll().forEach(function (e) { pokemonRepository.addListItem(e) }) });